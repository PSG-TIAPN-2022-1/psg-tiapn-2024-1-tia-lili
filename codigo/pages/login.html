<!DOCTYPE html>
<html lang="pt_br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <script src="../assets/js/app.js"></script>

    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body class="bg-light">

    <header>
        <nav class="navbar navbar-expand-lg navbar-light bg-success text-white">
            <div class="container" id="navbar">
    
                <a class="navbar-brand text-white" href="../index.html"><img src="../assets/img/tia lili.jpg" style="width: 120px;"></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#conteudoNavbarSuportado" aria-controls="conteudoNavbarSuportado" aria-expanded="false" aria-label="Alterna navegação">
                    <span class="navbar-toggler-icon"></span>
                </button>
    
                <div class="collapse navbar-collapse" id="conteudoNavbarSuportado">
                        
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="../index.html">Cardápio</a>
                        </li>
    
                        <li class="nav-item">
                            <a class="nav-link text-white" href="carrinho.html">Carrinho</a>
                        </li>
    
    
                        
                    </ul>
    
                    <div class="nav-item">
                        <a id="login_verif" class="nav-link  text-white" href="login.html">login</a>
                    </div>
    
                </div>
            </div>
        </nav>
    </header>

    <main class="container">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-6 bg-white p-4 rounded shadow-lg my-5">
                    <h3 class="text-center">Login</h3>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="email">E-mail</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="senha">Senha</label>
                            <input type="password" class="form-control" id="senha" name="senha" required>
                        </div>
                        <button type="submit" class="btn btn-success btn-block">Entrar</button>
                    </form>
                    <div class="text-center mt-3">
                        <a href="/codigo/pages/registro.html">Ainda não tem uma conta? Cadastre-se</a>
                    </div>
                    <div class="text-center mt-3" style="display: none;">
                        <a href="#">Esqueci minha senha</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="container-fluid justify-content-center text-light bg-dark">
        <div class="row my-5 justify-content-center py-5">
            <div class="col-11">
                <div class="row">
                    <div class="col-xl-8 col-md-4 col-sm-4 col-12 my-auto mx-auto a">
                        <h3 class="text-muted mb-md-0 mb-5 bold-text">Tia Lili Marmitex.</h3>
                    </div>
                    <div class="col-xl-2 col-md-4 col-sm-4 col-12">
                        <h6 class="mb-3 mb-lg-4 bold-text"><b>MENU</b></h6>
                        <ul class="list-unstyled">
                            <li>Marmitas</li>
                            <li>Bebidas</li>
                            <li>Especiais</li>
                            <li>Carrinho</li>
                            <li>Pedidos</li>
                            <li>Login</li>
                        </ul>
                    </div>
                    <div class="col-xl-2 col-md-4 col-sm-4 col-12">
                        <h6 class="mb-3 mb-lg-4 text-muted bold-text mt-sm-0 mt-5"><b>Endereço</b></h6>
                        <p class="mb-1">Rua Anori 175, São Gabriel</p>
                        <p>Belo Horizonte - MG</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xl-8 col-md-4 col-sm-4 col-auto my-md-0 mt-5 order-sm-1 order-3 align-self-end">
                        <p class="social text-muted mb-0 pb-0 bold-text">
                            <span class="mx-2"><i class="fa fa-facebook" aria-hidden="true"></i></span>
                            <span class="mx-2"><i class="fa fa-linkedin-square" aria-hidden="true"></i></span>
                            <span class="mx-2"><i class="fa fa-twitter" aria-hidden="true"></i></span>
                            <span class="mx-2"><i class="fa fa-instagram" aria-hidden="true"></i></span>
                        </p>
                        <small class="rights"><span>&#174;</span> Tia Lili Marmitex All Rights Reserved.</small>
                    </div>
                    <div class="col-xl-2 col-md-4 col-sm-4 col-auto order-1 align-self-end">
                        <h6 class="mt-55 mt-2 text-muted bold-text"><b>Contato</b></h6>
                        <small>
                            <span><i class="fa fa-envelope" aria-hidden="true"></i></span>
                            <a href="https://api.whatsapp.com/send/?phone=%2B5531971141408&text&type=phone_number&app_absent=0" class="text-light bold-text" target="_blank">+55 31 97114-1408</a>
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Ao enviar o formulário de login
            $('#loginForm').submit(function(event) {
                event.preventDefault();
    
                // Obter os valores do formulário
                var email = $('#email').val().trim();
                var senha = $('#senha').val().trim();
    
                // Montar o objeto de usuário para enviar ao servidor
                var user = {
                    email: email,
                    senha: senha
                };
    
                // Realizar a requisição POST para verificar o login
                read_user(user)
                    .then(usuario => {
                        // Verifica se há um usuário retornado
                        if (usuario) {
                            // Salva o usuário no localStorage
                            localStorage.setItem('usuario', JSON.stringify(usuario));
                            if (usuario.cargo === 'ADM') {
                                // Redirecionar para página de administrador
                                window.location.href = '../pages_adm/pedidos.html';
                            } else {
                                // Redirecionar para página de usuário normal
                                window.location.href = '../index.html';
                            }
                        } else {
                            alert('Usuário não encontrado! Verifique suas credenciais.');
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao realizar login:', error);
                        alert('Erro ao realizar login. Por favor, tente novamente mais tarde.');
                    });
            });
        });
    </script>
</body>
</html>
